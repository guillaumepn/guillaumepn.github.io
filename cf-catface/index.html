<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Catfish - Face</title>
  <link rel="stylesheet" href="style.css">
  <script src="path-data-polyfill.js"></script>
</head>
<body>
<div id="app">
    <div class="face">
      <svg width="340" height="297" viewBox="0 0 340 297" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <title>
          cat
        </title>
        <defs>
          <path d="M177.112 229.242c-5.177-3.32-8.792-6.163-10.847-8.528-1.773-2.04-4.392-6.035-7.857-11.984-.834-1.432-.35-3.268 1.083-4.102.132-.076.27-.143.41-.2 7.49-2.952 13.226-4.428 17.212-4.428 4.01 0 9.43 1.494 16.262 4.48 1.518.665 2.21 2.434 1.547 3.952-.01.022-.018.044-.03.065-2.726 5.853-5.018 9.926-6.874 12.217-2.135 2.636-5.77 5.478-10.904 8.528z" id="a"/>
        </defs>
        <g transform="translate(-9)" fill="none" fill-rule="evenodd">
          <ellipse class="head" :fill="colorHead" cx="178" cy="156" rx="144" ry="140"/>
          <g transform="translate(48 71)">
            <ellipse class="eye-bleft" :fill="colorEar" transform="rotate(46 64.5 64.5)" cx="64.5" cy="64.5" rx="46.5" ry="44.5"/>
            <ellipse class="eye-left" :fill="colorEye" transform="rotate(26 63.5 64.5)" cx="63.5" cy="64.5" rx="42.5" ry="36.5"/>
            <ellipse class="eye-inleft" fill="#000" cx="65" cy="52" rx="7" ry="24"/>
          </g>
          <g transform="matrix(-1 0 0 1 311 71)">
            <ellipse class="eye-bright" :fill="colorEar" transform="rotate(46 64.5 64.5)" cx="64.5" cy="64.5" rx="46.5" ry="44.5"/>
            <ellipse class="eye-right" :fill="colorEye" transform="rotate(26 63.5 64.5)" cx="63.5" cy="64.5" rx="42.5" ry="36.5"/>
            <ellipse class="eye-inright" fill="#000" cx="64" cy="52" rx="7" ry="24"/>
          </g>
          <path class="hair-left" d="M56.983 215c.933 15.888.13 25.646-2.41 29.274-2.537 3.628-7.73 11.112-15.573 22.453 12.47-1.7 21.748-3.603 27.83-5.706 6.084-2.102 14.157-6.2 24.22-12.29-3.31 11.038-6.297 18.737-8.963 23.1-2.666 4.36-8.354 10.853-17.062 19.478 16.595-4.244 28.042-7.842 34.34-10.794 6.297-2.952 12.332-7.547 18.105-13.787" :fill="colorHead"/>
          <path class="hair-right" d="M299.487 220c-.933 15.888-.13 25.646 2.41 29.274 2.537 3.628 7.73 11.112 15.573 22.453-12.47-1.7-21.748-3.603-27.83-5.706-6.084-2.102-14.157-6.2-24.22-12.29 3.31 11.038 6.297 18.737 8.963 23.1 2.666 4.36 8.354 10.853 17.062 19.478-16.595-4.244-28.042-7.842-34.34-10.794-6.297-2.952-12.332-7.547-18.105-13.787" :fill="colorHead"/>
          <path class="hair-uleft" d="M36.776 170.526c-4.858 9.276-8.617 14.507-11.278 15.693-2.66 1.185-8.125 3.647-16.392 7.384 7.61 3.267 13.486 5.338 17.63 6.213 4.143.875 10.084 1.3 17.823 1.276-5.608 5.103-9.902 8.432-12.883 9.99-2.982 1.555-8.39 3.29-16.223 5.203 10.797 3.23 18.472 5.08 23.023 5.55 4.552.468 9.513-.08 14.883-1.64" :fill="colorHead"/>
          <path class="hair-uright" d="M321.112 158.094c4.858 9.276 8.617 14.507 11.278 15.693 2.66 1.186 8.125 3.647 16.392 7.385-7.61 3.267-13.486 5.338-17.63 6.213-4.142.875-10.083 1.3-17.822 1.275 5.606 5.103 9.9 8.433 12.882 9.99 2.98 1.556 8.39 3.29 16.222 5.203-10.797 3.23-18.47 5.08-23.023 5.55-4.55.47-9.512-.078-14.882-1.64" :fill="colorHead"/>
          <path class="ear-left" d="M56.537 114c-17.092-11.086-28.543-21.49-34.353-31.216-5.81-9.725-8.097-37.32-6.857-82.784C32.46 6.87 47.757 12.543 61.22 17.02 74.68 21.496 93.273 35.87 117 60.144" :fill="colorHead"/>
          <path class="ear-inleft" d="M47.667 90C37.06 81.76 30.124 73.35 26.86 64.765c-3.266-8.584-5.61-26.946-7.032-55.087 7.64 4.62 16.065 8.84 25.272 12.653C54.308 26.147 69.94 35.703 92 51c-14.717 5.096-25.085 10.325-31.102 15.688C54.88 72.05 50.47 79.82 47.668 90z" :fill="colorEar"/>
          <path class="ear-right" d="M296.463 114c17.092-11.086 28.543-21.49 34.353-31.216 5.81-9.725 8.097-37.32 6.857-82.784-17.133 6.87-32.43 12.543-45.892 17.02-13.46 4.476-32.054 18.85-55.78 43.124" :fill="colorHead"/>
          <path class="ear-inright" d="M305.333 90c10.607-8.24 17.543-16.65 20.808-25.235 3.266-8.584 5.61-26.946 7.032-55.087-7.64 4.62-16.065 8.84-25.272 12.653-9.208 3.816-24.84 13.372-46.9 28.67 14.717 5.096 25.085 10.325 31.102 15.688C298.12 72.05 302.53 79.82 305.332 90z" :fill="colorEar"/>
          <g stroke="#979797">
            <path d="M143 228c0 9.39 7.61 17 17 17s17-7.61 17-17"/>
            <path d="M177 228c0 9.39 7.61 17 17 17s17-7.61 17-17"/>
          </g>
          <g stroke="#979797">
            <path d="M158 234.468c-18.564-3.687-32.263-5.092-41.096-4.216-8.832.877-23.8 5.126-44.904 12.748"/>
            <path d="M162 231c-16.26-10.72-29.956-17.685-41.086-20.895-11.13-3.21-32.1-6.246-62.914-9.105"/>
            <path d="M155 231c-16.57-5.994-29.76-9.705-39.57-11.133-9.81-1.43-26.286-2.037-49.43-1.826"/>
          </g>
          <g stroke="#979797">
            <path d="M195 234.468c18.564-3.687 32.263-5.092 41.096-4.216 8.832.877 23.8 5.126 44.904 12.748"/>
            <path d="M191 231c16.26-10.72 29.956-17.685 41.086-20.895 11.13-3.21 32.1-6.246 62.914-9.105"/>
            <path d="M198 231c16.57-5.994 29.76-9.705 39.57-11.133 9.81-1.43 26.286-2.037 49.43-1.826"/>
          </g>
          <use fill="#A885AC" xlink:href="#a"/>
        </g>
      </svg>
    </div>

    <form @submit="cancelSend">
        <input type="text" @keyup="generateCat()" class="name" autofocus>
    </form>
</div>

<script src="https://unpkg.com/vue"></script>
<script>
  let app = new Vue({
    el: '#app',
    data: {
      colorHead: '#CFCBCB',
      colorEar: '#9B9B9B',
      colorEye: '#A5C4E8'
    },
    methods: {
      generateCat: function () {
        let red = rand(0, 255)
        let green = rand(0, 255)
        let blue = rand(0, 255)
        let hslValues = rgbToHsl(red, green, blue)
        console.log(hslValues)
        this.colorHead = `rgb(${red},${green},${blue})`
        this.colorEar = shadeBlend(-0.2, this.colorHead)
        let hue = 0
        if ((hslValues[0] * 100) >= 50)
          hue = ((((hslValues[0] * 100) * 360)/100) - 50)
        else
          hue = ((((hslValues[0] * 100) * 360)/100) + 50)
        this.colorEye = `hsl(${hue.toFixed(0)}, ${(hslValues[1] * 100).toFixed(0)}%, 90%)`
      },
      cancelSend: function (e) {
        e.preventDefault()
      }
    }
  })

  function rand(min,max)
  {
    return Math.floor(Math.random()*(max-min+1)+min)
  }


  function shadeBlend(p,c0,c1) {
    var n=p<0?p*-1:p,u=Math.round,w=parseInt;
    if(c0.length>7){
      var f=c0.split(","),t=(c1?c1:p<0?"rgb(0,0,0)":"rgb(255,255,255)").split(","),R=w(f[0].slice(4)),G=w(f[1]),B=w(f[2]);
      return "rgb("+(u((w(t[0].slice(4))-R)*n)+R)+","+(u((w(t[1])-G)*n)+G)+","+(u((w(t[2])-B)*n)+B)+")"
    }else{
      var f=w(c0.slice(1),16),t=w((c1?c1:p<0?"#000000":"#FFFFFF").slice(1),16),R1=f>>16,G1=f>>8&0x00FF,B1=f&0x0000FF;
      return "#"+(0x1000000+(u(((t>>16)-R1)*n)+R1)*0x10000+(u(((t>>8&0x00FF)-G1)*n)+G1)*0x100+(u(((t&0x0000FF)-B1)*n)+B1)).toString(16).slice(1)
    }
  }

  function rgbToHsl(r, g, b) {
    r /= 255, g /= 255, b /= 255;

    var max = Math.max(r, g, b), min = Math.min(r, g, b);
    var h, s, l = (max + min) / 2;

    if (max == min) {
      h = s = 0; // achromatic
    } else {
      var d = max - min;
      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

      switch (max) {
        case r: h = (g - b) / d + (g < b ? 6 : 0); break;
        case g: h = (b - r) / d + 2; break;
        case b: h = (r - g) / d + 4; break;
      }

      h /= 6;
    }

    return [ h, s, l ];
  }

  let logPathSegments = (path) => {
    for (let seg of path.getPathData()) {
      if (seg.type === "M") {
        let [x, y] = seg.values;
        console.log(`M ${x} ${y}`);
      }
      else if (seg.type === "L") {
        let [x, y] = seg.values;
        console.log(`L ${x} ${y}`);
      }
      else if (seg.type === "C") {
        let [x1, y1, x2, y2, x, y] = seg.values;
        console.log(`C ${x1} ${y1} ${x2}, ${y2}, ${x} ${y}`);
      }
    }
  };


  /*
  Change on nose :
  transform: scale(0.8); // to 1.2
  transform-origin: center;
  fill: ...
  ---

  */
</script>
</body>
</html>